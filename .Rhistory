dem.stomach_cancer == 0 ~ 0,
dem.colon_cancer == 0 ~ 0,
dem.uterus_cancer == 0 ~ 0,
dem.prostate_cancer == 0 ~ 0
))
GLAD_signup_cancer_recode %>%
freq(any_cancer)
#Create char vector with physical health comorbidity variables
physical_health_comorbidity_variables <- c(
"dem.epilepsy_or_convulsions",
"dem.diabetes_type_1",
"dem.diabetes_type_2",
"dem.high_blood_pressure",
"dem.high_blood_cholesterol",
"dem.stroke",
"dem.migraines"
)
#See distribution in variables
physical_health_comorbidity_variables %>%
map(function(x){
group_by_at(GLAD_signup_cancer_recode, x) %>%
summarise(Count = n()) %>%
as_tibble()
})
GLAD_kits_received_raw <- read_csv(paste0(redcap_reports_folder_path, GLAD_kit_report_name))
#Check objects
GLAD_kits_received_raw %>%
head()
GLAD_kits_received_raw %>%
dim()
GLAD_kits_received_renamed <- GLAD_kits_received_raw %>%
rename("externalDataReference" = participant_id)
#Check
GLAD_kits_received_renamed %>%
colnames()
GLAD_signup_kits_returned <- GLAD_signup_cancer_recode %>%
mutate(kit_returned =
case_when(
externalDataReference %in% GLAD_kits_received_renamed$externalDataReference ~ 1,
externalDataReference %not_in% GLAD_kits_received_renamed$externalDataReference ~ 0
))
GLAD_signup_kits_returned$kit_returned_labelled <- factor(GLAD_signup_kits_returned$kit_returned,
levels = c(0, 1),
labels = c("Pt had not provided saliva kit",
"Pt has provided saliva kit"))
#Check new variable
GLAD_signup_kits_returned %>%
group_by_at(vars(starts_with("kit"))) %>%
count() #25,506 - Is this N lower because it's an old extraction?
GLAD_kits_received_renamed %>%
dim() #27,548
COPING_GLAD_invitations <- read_csv(paste0(redcap_reports_folder_path,
COPING_GLAD_invitations_name))
#Check data
COPING_GLAD_invitations %>%
head()
#Pt's joining after 30th April didn't receive the first batch of invitations
April_30th_2020 <- as.POSIXct("2020-04-30")
#Pt needed to complete their baseline before the first follow-up
May_19th_2020 <- as.POSIXct("2020-06-19")
GLAD_signup_first_invitation <- GLAD_signup_kits_returned %>%
mutate(joined_coping_first_invitation =
case_when(
endDate <= April_30th_2020 &
externalDataReference %in% COPING_GLAD_invitations$participant_id &
externalDataReference %in% COPING_GLAD_base_clean$externalDataReference &
COPING_GLAD_base_clean$endDate <= May_19th_2020 ~ 1,
endDate <= April_30th_2020 &
externalDataReference %in% COPING_GLAD_invitations$participant_id &
externalDataReference %in% COPING_GLAD_base_clean$externalDataReference &
COPING_GLAD_base_clean$endDate > May_19th_2020 ~ 0,
endDate <= April_30th_2020 &
externalDataReference %in% COPING_GLAD_invitations$participant_id &
externalDataReference %not_in% COPING_GLAD_base_clean$externalDataReference ~ 0,
endDate <= April_30th_2020 &
externalDataReference %not_in% COPING_GLAD_invitations$participant_id ~ 2,
endDate >= April_30th_2020 ~ 2
))
GLAD_signup_first_invitation$joined_coping_first_invitation <- factor(
GLAD_signup_first_invitation$joined_coping_first_invitation,
levels = c(0, 1, 2),
labels = c("Didn't complete COPING baseline before 1st follow-up",
"Completed COPING baseline before 1st follow-up",
"Not applicable")
)
#Check results
GLAD_signup_first_invitation %>%
group_by(joined_coping_first_invitation) %>%
count()
test <- GLAD_signup_first_invitation %>%
filter(joined_coping_first_invitation == "Completed COPING baseline before 1st follow-up")
#Get subset of COPING GLAD baseline with the IDs of these pt's
COPING_GLAD_endDate_test <- COPING_GLAD_base_clean %>%
subset_df_by_comparison_IDs(df_ID_col = "externalDataReference",
comparison_IDs = test$externalDataReference,
matching_IDs = TRUE)
#Check results
test %>%
dim()
COPING_GLAD_endDate_test %>%
dim()
COPING_GLAD_base_clean %>%
dim()
#View(COPING_GLAD_endDate_test$endDate)
#1 for normal coding, -1 for reverse coding
gad_sum_score_keys <- c(
1,
1,
1,
1,
1,
1,
1
) #No items are reverse coded for gad-7
# calculate total/sum score
gad_total_score <- scoreItems(keys = gad_sum_score_keys,
items = GLAD_signup_first_invitation[gad_variable_names],
totals = TRUE, #total sum score
missing = TRUE, #will include individuals that have missing values
impute = 'none', #does not impute the missing values, should we?
min = 0,
max = 3
)
#Add in total score column to data frame
GLAD_signup_gad_sum_scores <- GLAD_signup_first_invitation %>%
mutate(gad.sum_score =
as.numeric(gad_total_score$scores))
#check the values
GLAD_signup_gad_sum_scores %>%
freq(gad.sum_score)
#1 for normal coding, -1 for reverse coding
phq_sum_score_keys <- c(
1,
1,
1,
1,
1,
1,
1,
1,
1
) #No items in the PHQ are reverse coded
#calculate total/sum score
phq_total_score <- scoreItems(keys = phq_sum_score_keys,
items = GLAD_signup_gad_sum_scores[phq_variable_names],
totals = TRUE, #total sum score
missing = TRUE, #will include individuals that have missing values
impute = 'none', #does not impute the missing values, should we?
min = 0,
max = 3
)
#Add in total score column to data frame
GLAD_signup_phq_sum_scores <- GLAD_signup_gad_sum_scores %>%
mutate(phq.sum_score =
as.numeric(phq_total_score$scores))
#check the values
GLAD_signup_phq_sum_scores %>%
freq(phq.sum_score)
#1 for normal coding, -1 for reverse coded
audit_sum_score_keys <- c(
1,
1,
1,
1,
1,
1,
1,
1,
1,
1
) #No items in the audit are reverse coded
# calculate total/sum score
audit_total_score <- scoreItems(keys = audit_sum_score_keys,
items = GLAD_signup_phq_sum_scores[audit_variable_names],
totals = TRUE, #total sum score
missing = TRUE, #will include individuals that have missing values
impute = 'none', #does not impute the missing values, should we?
min = 0,
max = 4
)
#Add in total score column to data frame
GLAD_signup_audit_sum_scores <- GLAD_signup_phq_sum_scores %>%
mutate(audit.sum_score =
as.numeric(audit_total_score$scores))
#check the values
GLAD_signup_audit_sum_scores %>%
freq(audit.sum_score)
GLAD_signup_depressive_disorder <- GLAD_signup_audit_sum_scores %>%
mutate(depressive_disorder =
case_when(
mhd.mdd == 1 ~ 1,
mhd.perinatal_depression == 1 ~ 1,
mhd.pmdd == 1 ~ 1,
(mhd.mdd == 0 &
mhd.perinatal_depression == 0 &
mhd.pmdd == 0 ~ 0
)
))
GLAD_signup_depressive_disorder$depressive_disorder_labelled <- factor(
GLAD_signup_depressive_disorder$depressive_disorder,
levels = c(0, 1),
labels = c("No depressive disorder", "Depressive disorder")
)
#Check results
GLAD_signup_depressive_disorder %>%
group_by(depressive_disorder_labelled) %>%
count()
GLAD_signup_anxiety_disorder <- GLAD_signup_depressive_disorder %>%
mutate(anxiety_disorder =
case_when(
mhd.gad == 1 ~ 1,
mhd.social_anxiety == 1 ~ 1,
mhd.specific_phobia == 1 ~ 1,
mhd.agoraphobia == 1 ~ 1,
mhd.panic_disorder == 1 ~ 1,
mhd.panic_attacks == 1 ~ 1,
(mhd.gad == 0 &
mhd.social_anxiety == 0 &
mhd.specific_phobia == 0 &
mhd.agoraphobia == 0 &
mhd.panic_disorder == 0 ~ 0
)
))
GLAD_signup_anxiety_disorder$anxiety_disorder_labelled <- factor(
GLAD_signup_anxiety_disorder$anxiety_disorder,
levels = c(0, 1),
labels = c("No anxiety disorder", "Anxiety disorder")
)
#Check results
GLAD_signup_anxiety_disorder %>%
group_by(anxiety_disorder_labelled) %>%
count()
GLAD_signup_depression_and_anxiety <- GLAD_signup_anxiety_disorder %>%
mutate(depressive_and_anxiety_comorbidity =
case_when(
depressive_disorder == 1 &
anxiety_disorder == 1 ~ 1,
depressive_disorder == 0 &
anxiety_disorder == 0 ~ 0,
depressive_disorder == 1 &
anxiety_disorder == 0 ~ 2,
depressive_disorder == 0 &
anxiety_disorder == 1 ~ 3
))
GLAD_signup_depression_and_anxiety$depressive_and_anxiety_disorder_labelled <- factor(
GLAD_signup_depression_and_anxiety$depressive_and_anxiety_disorder,
levels = c(0, 1, 2, 3),
labels = c("No depressive and anxiety disorder", "Depressive and anxiety disorder",
"Depressive disorder only", "Anxiety disorder only")
)
GLAD_signup_depression_and_anxiety$depressive_and_anxiety_comorbidity_labelled <- factor(
GLAD_signup_depression_and_anxiety$depressive_and_anxiety_comorbidity,
levels = c(0, 1, 2, 3),
labels = c("No depressive and anxiety disorder", "Depressive and anxiety disorder",
"Depressive disorder only", "Anxiety disorder only")
)
#Check results
GLAD_signup_depression_and_anxiety %>%
group_by(depressive_and_anxiety_disorder_labelled) %>%
count()
#Check results
GLAD_signup_depression_and_anxiety %>%
group_by(depressive_and_anxiety_comorbidity_labelled) %>%
count()
GLAD_signup_depression_and_anxiety$PTSD_labelled <- factor(
GLAD_signup_depression_and_anxiety$mhd.ptsd,
levels = c(0, 1),
labels = c("No Post-traumatic stress disorder", "Post-traumatic stress disorder")
)
#Check values
GLAD_signup_depression_and_anxiety %>%
group_by(PTSD_labelled) %>%
count()
GLAD_signup_OCRDs <- GLAD_signup_depression_and_anxiety %>%
mutate(OCRDs =
case_when(
mhd.ocd == 1 ~ 1,
mhd.other_ocd == 1 ~ 1,
(mhd.ocd == 0 &
mhd.other_ocd == 0 ~ 0
)
))
GLAD_signup_OCRDs$OCRDs_labelled <- factor(
GLAD_signup_OCRDs$OCRDs,
levels = c(0, 1),
labels = c("No OCRDs", "OCRDs")
)
#Check results
GLAD_signup_OCRDs %>%
group_by(OCRDs_labelled) %>%
count()
GLAD_signup_eating_disorders <- GLAD_signup_OCRDs %>%
mutate(eating_disorders =
case_when(
mhd.an == 1 ~ 1,
mhd.atypical_an == 1 ~ 1,
mhd.bn == 1 ~ 1,
mhd.bed == 1 ~ 1,
(mhd.an == 0 &
mhd.atypical_an == 0 &
mhd.bn == 0 &
mhd.bed == 0 ~ 0
)
))
GLAD_signup_eating_disorders$eating_disorders_labelled <- factor(
GLAD_signup_eating_disorders$eating_disorders,
levels = c(0, 1),
labels = c("No eating disorder", "Eating disorder")
)
#Check results
GLAD_signup_eating_disorders %>%
group_by(eating_disorders_labelled) %>%
count()
GLAD_signup_eating_disorders$personality_disorder_labelled <- factor(
GLAD_signup_eating_disorders$mhd.personality_disorder,
levels = c(0, 1),
labels = c("No personality disorder", "Personality disorder")
)
#Check results
GLAD_signup_eating_disorders %>%
group_by(personality_disorder_labelled) %>%
count()
GLAD_signup_personality_disorders <- GLAD_signup_eating_disorders %>%
mutate(personality_cluster_A =
case_when(
mhd.personality_disorder_diagnosed == 1 ~ 1,
mhd.personality_disorder_diagnosed == 2 ~ 1,
mhd.personality_disorder_diagnosed == 3 ~ 1,
mhd.personality_disorder_diagnosed == 4 ~ 0,
mhd.personality_disorder_diagnosed == 5 ~ 0,
mhd.personality_disorder_diagnosed == 6 ~ 0,
mhd.personality_disorder_diagnosed == 7 ~ 0,
mhd.personality_disorder_diagnosed == 8 ~ 0,
mhd.personality_disorder_diagnosed == 9 ~ 0,
mhd.personality_disorder_diagnosed == 10 ~ 0,
)
)
GLAD_signup_personality_disorders$personality_cluster_A_labelled <- factor(
GLAD_signup_personality_disorders$personality_cluster_A,
levels = c(0, 1),
labels = c("No cluster A personality disorder", "Cluster A personality disorder")
)
#Check results
GLAD_signup_personality_disorders %>%
group_by(personality_cluster_A_labelled) %>%
count()
GLAD_signup_personality_disorders <- GLAD_signup_personality_disorders %>%
mutate(personality_cluster_B =
case_when(
mhd.personality_disorder_diagnosed == 1 ~ 0,
mhd.personality_disorder_diagnosed == 2 ~ 0,
mhd.personality_disorder_diagnosed == 3 ~ 0,
mhd.personality_disorder_diagnosed == 4 ~ 1,
mhd.personality_disorder_diagnosed == 5 ~ 1,
mhd.personality_disorder_diagnosed == 6 ~ 1,
mhd.personality_disorder_diagnosed == 7 ~ 1,
mhd.personality_disorder_diagnosed == 8 ~ 0,
mhd.personality_disorder_diagnosed == 9 ~ 0,
mhd.personality_disorder_diagnosed == 10 ~ 0,
)
)
GLAD_signup_personality_disorders$personality_cluster_B_labelled <- factor(
GLAD_signup_personality_disorders$personality_cluster_B,
levels = c(0, 1),
labels = c("No cluster B personality disorder", "Cluster B personality disorder")
)
#Check results
GLAD_signup_personality_disorders %>%
group_by(personality_cluster_B_labelled) %>%
count()
GLAD_signup_personality_disorders <- GLAD_signup_personality_disorders %>%
mutate(personality_cluster_C =
case_when(
mhd.personality_disorder_diagnosed == 1 ~ 0,
mhd.personality_disorder_diagnosed == 2 ~ 0,
mhd.personality_disorder_diagnosed == 3 ~ 0,
mhd.personality_disorder_diagnosed == 4 ~ 0,
mhd.personality_disorder_diagnosed == 5 ~ 0,
mhd.personality_disorder_diagnosed == 6 ~ 0,
mhd.personality_disorder_diagnosed == 7 ~ 0,
mhd.personality_disorder_diagnosed == 8 ~ 1,
mhd.personality_disorder_diagnosed == 9 ~ 1,
mhd.personality_disorder_diagnosed == 10 ~ 1,
)
)
GLAD_signup_personality_disorders$personality_cluster_C_labelled <- factor(
GLAD_signup_personality_disorders$personality_cluster_C,
levels = c(0, 1),
labels = c("No cluster C personality disorder", "Cluster C personality disorder")
)
#Check results
GLAD_signup_personality_disorders %>%
group_by(personality_cluster_C_labelled) %>%
count()
glad_signup_psychosis <- GLAD_signup_personality_disorders %>%
mutate(psychotic_disorder =
case_when(
mhd.schizophrenia == 1 ~ 1,
mhd.schizoaffective == 1 ~ 1,
mhd.psychosis == 1 ~ 1,
(mhd.schizophrenia == 0 &
mhd.schizoaffective == 0 &
mhd.psychosis == 0 ~ 0
)
))
glad_signup_psychosis$psychotic_disorder_labelled <- factor(
glad_signup_psychosis$psychotic_disorder,
levels = c(0, 1),
labels = c("No psychotic disorder", "Psychotic disorder")
)
#Check results
glad_signup_psychosis %>%
group_by(psychotic_disorder_labelled) %>%
count()
glad_signup_psychosis$bipolar_disorder_labelled <- factor(
glad_signup_psychosis$mhd.bipolar_disorder,
levels = c(0, 1),
labels = c("No bipolar disorder", "Bipolar disorder")
)
#Check results
glad_signup_psychosis %>%
group_by(bipolar_disorder_labelled) %>%
count()
glad_signup_psychosis_and_bipolar <- glad_signup_psychosis %>%
mutate(psychotic_and_biploar_disorder =
case_when(
psychotic_disorder == 0 &
mhd.bipolar_disorder == 0 ~ 0,
psychotic_disorder == 1 &
mhd.bipolar_disorder == 1 ~ 1,
psychotic_disorder == 1 &
mhd.bipolar_disorder == 0 ~ 2,
psychotic_disorder == 0 &
mhd.bipolar_disorder == 1 ~ 3
))
glad_signup_psychosis_and_bipolar$psychotic_and_biploar_disorder_labelled <- factor(
glad_signup_psychosis_and_bipolar$psychotic_and_biploar_disorder,
levels = c(0, 1, 2, 3),
labels = c("0" = "No psychotic or bipolar disorder",
"1" = "Psychotic and bipolar disorder",
"2" = "Only psychotic disorder",
"3" = "Only bipolar disorder")
)
#Check results
glad_signup_psychosis_and_bipolar %>%
group_by(psychotic_and_biploar_disorder_labelled) %>%
count()
glad_signup_psychosis <- GLAD_signup_personality_disorders %>%
mutate(psychotic_disorder =
case_when(
mhd.schizophrenia == 1 ~ 1,
mhd.schizoaffective == 1 ~ 1,
mhd.psychosis == 1 ~ 1,
(mhd.schizophrenia == 0 &
mhd.schizoaffective == 0 |
is.na(mhd.schizoaffective) &
mhd.psychosis == 0 ~ 0
)
))
glad_signup_psychosis$psychotic_disorder_labelled <- factor(
glad_signup_psychosis$psychotic_disorder,
levels = c(0, 1),
labels = c("No psychotic disorder", "Psychotic disorder")
)
#Check results
glad_signup_psychosis %>%
group_by(psychotic_disorder_labelled) %>%
count()
glad_signup_psychosis_and_bipolar <- glad_signup_psychosis %>%
mutate(psychotic_and_biploar_disorder =
case_when(
psychotic_disorder == 0 &
mhd.bipolar_disorder == 0 ~ 0,
psychotic_disorder == 1 &
mhd.bipolar_disorder == 1 ~ 1,
psychotic_disorder == 1 &
mhd.bipolar_disorder == 0 ~ 2,
psychotic_disorder == 0 &
mhd.bipolar_disorder == 1 ~ 3
))
glad_signup_psychosis_and_bipolar$psychotic_and_biploar_disorder_labelled <- factor(
glad_signup_psychosis_and_bipolar$psychotic_and_biploar_disorder,
levels = c(0, 1, 2, 3),
labels = c("0" = "No psychotic or bipolar disorder",
"1" = "Psychotic and bipolar disorder",
"2" = "Only psychotic disorder",
"3" = "Only bipolar disorder")
)
#Check results
glad_signup_psychosis_and_bipolar %>%
group_by(psychotic_and_biploar_disorder_labelled) %>%
count()
glad_signup_psychosis_and_bipolar$autistic_spectrum_disorder <- factor(
glad_signup_psychosis_and_bipolar$mhd.asd,
levels = c(0, 1),
labels = c("No autistic spectrum disorder", "Autistic spectrum disorder")
)
#Check results
glad_signup_psychosis_and_bipolar %>%
group_by(autistic_spectrum_disorder) %>%
count()
glad_signup_psychosis_and_bipolar$ADHD_ADD_labelled <- factor(
glad_signup_psychosis_and_bipolar$mhd.addadhd,
levels = c(0, 1),
labels = c("No ADHD or ADD disorder", "ADHD or ADD disorder")
)
#Check results
glad_signup_psychosis_and_bipolar %>%
group_by(ADHD_ADD_labelled) %>%
count()
knitr::opts_chunk$set(echo = TRUE)
View(setdiff)
