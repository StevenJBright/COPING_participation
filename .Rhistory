"kit_returnedPt has provided saliva kit"
#"joined_coping_first_invitationCompleted COPING baseline before 1st follow-up"
)
#Create tidy model output
complete_LR_model_tidy <- tidy(
complete_LR_model,
exponentiate = T,
conf.int = T) %>%
mutate(
Variable = complete_LR_model_names,
Significance = if_else(
p.value < 0.05,
1,
0
) %>%
recode_factor(
"0" = "Not-significant",
"1" = "Significant"
)) %>%
select(
Variable,
OR = estimate,
`CI 95% lower` = conf.low,
`CI 95% upper` = conf.high,
p.value,
Significance
) %>%
mutate(
adj.p.value = p.adjust(p.value,
"bonferroni"),
adj_significance = if_else(
adj.p.value < 0.05,
1,
0
)
)
knitr::opts_chunk$set(echo = TRUE)
remove(list = ls())
#Change it to "= 0" to turn it back on
options(scipen = 999)
#install.packages("broom")
#install.packages("knitr)
#install.packages("car")
#install.packages("rstatix")
#install.packages("pscl")
#install.packages("stargazer")
#install.packages("boot")
#install.packages("stats")
#install.packages("rcompanion")
#install.packages("MASS")
#install.packages("tidyverse")
library(broom)
library(knitr)
library(car)
library(rstatix)
library(pscl)
library(stargazer)
library(boot)
library(stats)
library(rcompanion)
library(MASS)
library(tidyverse)
source("..//COPING_participation_paths.r")
source("..//COPING_participation_functions.r")
glad_coping_participation_raw <- read_rds(paste0(processed_data_path, processed_data_name))
#Check data
glad_coping_participation_raw %>%
head()
#Note: Have left out the "depressive_and_anxiety_comorbidity_labelled" variable
#because this is acting as the reference group for MH diagnoses.
complete_LR_model <- glm(
formula = completed_baseline_labelled ~ age_cleaned +
gender_recode_labelled +
highest_education_labelled +
ethnicity_labelled +
employment_labelled +
partnership_status_labelled +
phq.sum_score +
gad.sum_score +
audit.sum_score +
smoking_status_labelled +
physical_health_comorbidities_labelled +
MH_disorders_total_count +
eating_disorders_labelled +
OCRDs_labelled +
psychotic_and_biploar_disorder_labelled +
asd_labelled +
ADHD_ADD_labelled +
personality_disorder_labelled +
PTSD_labelled +
startDate +
kit_returned_labelled,
#joined_coping_first_invitation_labelled,
family = "binomial",
data = glad_coping_participation_raw)
#Check output
summary(complete_LR_model)
complete_LR_model %>%
nagelkerke()
#Put all LR variable names into vector in the order they appear in summary(model4)
complete_LR_model_names <- c(
"Intercept",
"age_cleaned",
"gender_recode_labelledFemale",
"gender_recode_labelledNon-binary/prefer to self-define",
"highest_education_labelledA levels/AS levels or equivalent",
"highest_education_labelledO levels/GCSEs or equivalent",
"highest_education_labelledCSEs or equivalent",
"highest_education_labelledNVQ or HND or HNC or equivalent",
"highest_education_labelledNone of the above",
"ethnicity_labelledMixed",
"ethnicity_labelledAsian or Asian British",
"ethnicity_labelledBlack or Black British",
"ethnicity_labelledArab",
"ethnicity_labelledOther",
"employment_labelledRetired",
"employment_labelledLooking after home and/or family",
"employment_labelledUnable to work because of sickness or disability",
"employment_labelledUnemployed",
"employment_labelledDoing unpaid or voluntary work",
"employment_labelledFull or part-time_student",
"employment_labelledNone of the above",
"partnership_status_labelledRelationship or married/civil partnership",
"partnership_status_labelledDivorced/widowed/separated",
"phq.sum_score",
"gad.sum_score",
"audit.sum_score",
"smoking_status_labelledI smoke now",
"smoking_status_labelledI used to smoke",
"physical_health_comorbidities_labelled1 physical health disorder",
"physical_health_comorbidities_labelled2+ physical health disorders",
"MH_disorders_total_count",
"eating_disorders_labelledEating disorder",
"OCRDs_labelledOCRDs",
"psychotic_and_biploar_disorder_labelledPsychotic and bipolar disorder",
"psychotic_and_biploar_disorder_labelledOnly psychotic disorder",
"psychotic_and_biploar_disorder_labelledOnly bipolar disorder",
"asd_labelledAutistic spectrum disorder",
"ADHD_ADD_labelledADHD or ADD disorder",
"mhd.personality_disorder_labelledPersonality disorder",
"PTSD_labelledPost-traumatic stress disorder",
"startDate",
"kit_returnedPt has provided saliva kit"
#"joined_coping_first_invitationCompleted COPING baseline before 1st follow-up"
)
#Create tidy model output
complete_LR_model_tidy <- tidy(
complete_LR_model,
exponentiate = T,
conf.int = T) %>%
mutate(
Variable = complete_LR_model_names,
Significance = if_else(
p.value < 0.05,
1,
0
) %>%
recode_factor(
"0" = "Not-significant",
"1" = "Significant"
)) %>%
select(
Variable,
OR = estimate,
`CI 95% lower` = conf.low,
`CI 95% upper` = conf.high,
p.value,
Significance
) %>%
mutate(
adj.p.value = p.adjust(p.value,
"bonferroni"),
adj_significance = if_else(
adj.p.value < 0.05,
1,
0
)
)
#Create tidy model output
complete_LR_model_tidy <- tidy(
complete_LR_model,
exponentiate = T,
conf.int = T) %>%
mutate(
Variable = complete_LR_model_names,
Significance = if_else(
p.value < 0.05,
1,
0
) %>%
recode_factor(
"0" = "Not-significant",
"1" = "Significant"
)) %>%
select(
Variable,
OR = estimate,
"CI 95% lower" = conf.low,
"CI 95% upper" = conf.high,
p.value,
Significance
) %>%
mutate(
adj.p.value = p.adjust(p.value,
"bonferroni"),
adj_significance = if_else(
adj.p.value < 0.05,
1,
0
)
)
#Note: Have left out the "depressive_and_anxiety_comorbidity_labelled" variable
#because this is acting as the reference group for MH diagnoses.
complete_LR_model <- glm(
formula = completed_baseline_labelled ~ age_cleaned +
gender_recode_labelled +
highest_education_labelled +
ethnicity_labelled +
employment_labelled +
partnership_status_labelled +
phq.sum_score +
gad.sum_score +
audit.sum_score +
smoking_status_labelled +
physical_health_comorbidities_labelled +
MH_disorders_total_count +
eating_disorders_labelled +
OCRDs_labelled +
psychotic_and_biploar_disorder_labelled +
asd_labelled +
ADHD_ADD_labelled +
personality_disorder_labelled +
PTSD_labelled +
startDate +
kit_returned_labelled,
#joined_coping_first_invitation_labelled,
family = "binomial",
data = glad_coping_participation_raw)
#Check output
summary(complete_LR_model)
#Put all LR variable names into vector in the order they appear in summary(model4)
complete_LR_model_names <- c(
"Intercept",
"age_cleaned",
"gender_recode_labelledFemale",
"gender_recode_labelledNon-binary/prefer to self-define",
"highest_education_labelledA levels/AS levels or equivalent",
"highest_education_labelledO levels/GCSEs or equivalent",
"highest_education_labelledCSEs or equivalent",
"highest_education_labelledNVQ or HND or HNC or equivalent",
"highest_education_labelledNone of the above",
"ethnicity_labelledMixed",
"ethnicity_labelledAsian or Asian British",
"ethnicity_labelledBlack or Black British",
"ethnicity_labelledArab",
"ethnicity_labelledOther",
"employment_labelledRetired",
"employment_labelledLooking after home and/or family",
"employment_labelledUnable to work because of sickness or disability",
"employment_labelledUnemployed",
"employment_labelledDoing unpaid or voluntary work",
"employment_labelledFull or part-time_student",
"employment_labelledNone of the above",
"partnership_status_labelledRelationship or married/civil partnership",
"partnership_status_labelledDivorced/widowed/separated",
"phq.sum_score",
"gad.sum_score",
"audit.sum_score",
"smoking_status_labelledI smoke now",
"smoking_status_labelledI used to smoke",
"physical_health_comorbidities_labelled1 physical health disorder",
"physical_health_comorbidities_labelled2+ physical health disorders",
"MH_disorders_total_count",
"eating_disorders_labelledEating disorder",
"OCRDs_labelledOCRDs",
"psychotic_and_biploar_disorder_labelledPsychotic and bipolar disorder",
"psychotic_and_biploar_disorder_labelledOnly psychotic disorder",
"psychotic_and_biploar_disorder_labelledOnly bipolar disorder",
"asd_labelledAutistic spectrum disorder",
"ADHD_ADD_labelledADHD or ADD disorder",
"mhd.personality_disorder_labelledPersonality disorder",
"PTSD_labelledPost-traumatic stress disorder",
"startDate",
"kit_returnedPt has provided saliva kit"
#"joined_coping_first_invitationCompleted COPING baseline before 1st follow-up"
)
#Create tidy model output
complete_LR_model_tidy <- tidy(
complete_LR_model,
exponentiate = T,
conf.int = T) %>%
mutate(
Variable = complete_LR_model_names,
Significance = if_else(
p.value < 0.05,
1,
0
) %>%
recode_factor(
"0" = "Not-significant",
"1" = "Significant"
)) %>%
select(
Variable,
OR = estimate,
`CI 95% lower` = conf.low,
`CI 95% upper` = conf.high,
p.value,
Significance
) %>%
mutate(
adj.p.value = p.adjust(p.value,
"bonferroni"),
adj_significance = if_else(
adj.p.value < 0.05,
1,
0
)
)
complete_LR_model_tidy <- tidy(
complete_LR_model,
exponentiate = T,
conf.int = T) %>%
mutate(
Variable = complete_LR_model_names,
Significance = if_else(
p.value < 0.05,
1,
0
) %>%
recode_factor(
"0" = "Not-significant",
"1" = "Significant"
))
#Create tidy model output
complete_LR_model_tidy <- tidy(
complete_LR_model,
exponentiate = T,
conf.int = T) %>%
mutate(
Variable = complete_LR_model_names,
Significance = if_else(
p.value < 0.05,
1,
0
) %>%
recode_factor(
"0" = "Not-significant",
"1" = "Significant"
)) %>%
dplyr::select(
Variable,
OR = estimate,
`CI 95% lower` = conf.low,
`CI 95% upper` = conf.high,
p.value,
Significance
) %>%
mutate(
adj.p.value = p.adjust(p.value,
"bonferroni"),
adj_significance = if_else(
adj.p.value < 0.05,
1,
0
)
)
complete_LR_model_tidy %>%
head(nrow(complete_LR_model_tidy))
#Create kable output
#complete_LR_model_kable <- kable(complete_LR_model_tidy[-c(1), ],
#      digits = 2)
knitr::opts_chunk$set(echo = TRUE)
remove(list = ls())
#Change it to "= 0" to turn it back on
options(scipen = 999)
#install.packages("broom")
#install.packages("knitr)
#install.packages("car")
#install.packages("rstatix")
#install.packages("pscl")
#install.packages("stargazer")
#install.packages("boot")
#install.packages("stats")
#install.packages("rcompanion")
#install.packages("MASS")
#install.packages("tidyverse")
library(broom)
library(knitr)
library(car)
library(rstatix)
library(pscl)
library(stargazer)
library(boot)
library(stats)
library(rcompanion)
library(MASS)
library(tidyverse)
source("..//COPING_participation_paths.r")
source("..//COPING_participation_functions.r")
glad_coping_participation_raw <- read_rds(paste0(processed_data_path, processed_data_name))
#Check data
glad_coping_participation_raw %>%
head()
#Note: Have left out the "depressive_and_anxiety_comorbidity_labelled" variable
#because this is acting as the reference group for MH diagnoses.
complete_LR_model <- glm(
formula = completed_baseline_labelled ~ age_cleaned +
gender_recode_labelled +
highest_education_labelled +
ethnicity_labelled +
employment_labelled +
partnership_status_labelled +
phq.sum_score +
gad.sum_score +
audit.sum_score +
smoking_status_labelled +
physical_health_comorbidities_labelled +
MH_disorders_total_count +
eating_disorders_labelled +
OCRDs_labelled +
psychotic_and_biploar_disorder_labelled +
asd_labelled +
ADHD_ADD_labelled +
personality_disorder_labelled +
PTSD_labelled +
startDate +
kit_returned_labelled,
#joined_coping_first_invitation_labelled,
family = "binomial",
data = glad_coping_participation_raw)
#Check output
summary(complete_LR_model)
complete_LR_model %>%
nagelkerke()
#Put all LR variable names into vector in the order they appear in summary(model4)
complete_LR_model_names <- c(
"Intercept",
"age_cleaned",
"gender_recode_labelledFemale",
"gender_recode_labelledNon-binary/prefer to self-define",
"highest_education_labelledA levels/AS levels or equivalent",
"highest_education_labelledO levels/GCSEs or CSEs or equivalent",
"highest_education_labelledNVQ or HND or HNC or equivalent",
"highest_education_labelledNone of the above",
"ethnicity_labelledMixed",
"ethnicity_labelledAsian or Asian British",
"ethnicity_labelledBlack or Black British",
"ethnicity_labelledArab",
"ethnicity_labelledOther",
"employment_labelledRetired",
"employment_labelledLooking after home and/or family",
"employment_labelledUnable to work because of sickness or disability",
"employment_labelledUnemployed",
"employment_labelledDoing unpaid or voluntary work",
"employment_labelledFull or part-time_student",
"employment_labelledNone of the above",
"partnership_status_labelledRelationship or married/civil partnership",
"partnership_status_labelledDivorced/widowed/separated",
"phq.sum_score",
"gad.sum_score",
"audit.sum_score",
"smoking_status_labelledI smoke now",
"smoking_status_labelledI used to smoke",
"physical_health_comorbidities_labelled1 physical health disorder",
"physical_health_comorbidities_labelled2+ physical health disorders",
"MH_disorders_total_count",
"eating_disorders_labelledEating disorder",
"OCRDs_labelledOCRDs",
"psychotic_and_biploar_disorder_labelledPsychotic and bipolar disorder",
"psychotic_and_biploar_disorder_labelledOnly psychotic disorder",
"psychotic_and_biploar_disorder_labelledOnly bipolar disorder",
"asd_labelledAutistic spectrum disorder",
"ADHD_ADD_labelledADHD or ADD disorder",
"mhd.personality_disorder_labelledPersonality disorder",
"PTSD_labelledPost-traumatic stress disorder",
"startDate",
"kit_returnedPt has provided saliva kit"
#"joined_coping_first_invitationCompleted COPING baseline before 1st follow-up"
)
ZINB_variables <- c(
"age_cleaned",
"gender_recode_labelled",
"highest_education_labelled",
"ethnicity_labelled",
"employment_labelled",
"partnership_status_labelled",
"phq.sum_score",
"gad.sum_score",
"audit.sum_score",
"smoking_status_labelled",
"physical_health_comorbidities_labelled",
"MH_disorders_total_count",
"eating_disorders_labelled",
"OCRDs_labelled",
"psychotic_and_biploar_disorder_labelled",
"asd_labelled",
"ADHD_ADD_labelled",
"personality_disorder_labelled",
"PTSD_labelled",
"kit_returned_labelled"
)
ZINB_variables
exploratory_ZINB_variables <- ZINB_variables %>%
filter(ZINB_variables != "kit_returned_labelled")
exploratory_ZINB_variables <- ZINB_variables %>%
str_remove("kit_returned_labelled")
exploratory_ZINB_variables
ZINB_variables
exploratory_ZINB_variables
exploratory_ZINB_variables <- ZINB_variables[ZINB_variables != "kit_returned_labelled"]
exploratory_ZINB_variables
