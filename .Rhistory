select(-all_of(COPING_baseline_table_variable_exclusions)) %>%
tbl_summary(missing_text = "Missing",
by = "completed_baseline_labelled")
knitr::opts_chunk$set(echo = TRUE)
remove(list = ls())
#install.packages("cowplot")
#install.packages("grid")
#install.packages("gridExtra")
#install.packages("gtsummary")
#install.packages("tidyverse")
library(cowplot)
library(grid)
library(gridExtra)
library(gtsummary)
library(tidyverse)
glad_coping_palette2 <- c("#EFC10B", "#B7DEE8")
glad_coping_palette3 <- c("#EFC10B", "#B7DEE8", "#0403ff")
source("..//COPING_participation_paths.r")
source("..//COPING_participation_functions.r")
glad_coping_participation <- read_rds(paste0(processed_data_path, processed_data_name))
#Check data
glad_coping_participation %>%
head()
age_group_plot <- glad_coping_participation %>%
ggplot(aes(x = age_groups_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Age (years)",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
age_group_plot
gender_plot <- glad_coping_participation %>%
ggplot(aes(x = gender_recode_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Gender",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
gender_plot
employment_plot <- glad_coping_participation %>%
drop_na(employment_labelled) %>%
ggplot(aes(x = employment_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Employment status",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
employment_plot
ethnicity_plot <- glad_coping_participation %>%
drop_na(ethnicity_labelled) %>%
ggplot(aes(x = ethnicity_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Ethnic identity",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
ethnicity_plot
ethnic_minority_plot <- glad_coping_participation %>%
drop_na(ethnicity_labelled) %>%
filter(ethnicity_labelled != "White") %>%
drop_na(ethnicity_labelled) %>%
ggplot(aes(x = ethnicity_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Ethnic minority identity",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
ethnic_minority_plot
plot_layout_matrix <- matrix(c(1, 1, 2, 3, 3, 4), nrow = 2, byrow = TRUE)
#See matrix
plot_layout_matrix
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_group_plot,
employment_plot,
gender_plot,
layout_matrix = plot_layout_matrix,
nrow = 2)
age_group_COPING_waves_plot <- glad_coping_participation %>%
ggplot(aes(x = age_groups_labelled, fill = total_COPING_waves_binary_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Age (years)",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette3) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
age_group_COPING_waves_plot
gender_COPING_waves_plot <- glad_coping_participation %>%
ggplot(aes(x = gender_recode_labelled, fill = total_COPING_waves_binary_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Gender",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
gender_COPING_waves_plot
employment_COPING_waves_plot <- glad_coping_participation %>%
drop_na(employment_labelled) %>%
ggplot(aes(x = employment_labelled, fill = total_COPING_waves_binary_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Employment status",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
employment_COPING_waves_plot
ethnicity_COPING_waves_plot <- glad_coping_participation %>%
drop_na(ethnicity_labelled) %>%
ggplot(aes(x = ethnicity_labelled, fill = total_COPING_waves_binary_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Ethnic identity",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
ethnicity_COPING_waves_plot
ethnic_minority_COPING_waves_plot <- glad_coping_participation %>%
drop_na(ethnicity_labelled) %>%
filter(ethnicity_labelled != "White") %>%
drop_na(ethnicity_labelled) %>%
ggplot(aes(x = ethnicity_labelled, fill = total_COPING_waves_binary_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Ethnic minority identity",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none")
#Check plot
ethnic_minority_plot
COPING_waves_layout_matrix <- matrix(c(1, 1, 2, 3, 3, 4), nrow = 2, byrow = TRUE)
#See matrix
COPING_waves_layout_matrix
demographics_COPING_waves_plot <- grid.arrange(ethnic_minority_COPING_waves_plot,
age_group_COPING_waves_plot,
employment_COPING_waves_plot,
gender_COPING_waves_plot,
layout_matrix = COPING_waves_layout_matrix,
nrow = 2)
COPING_baseline_table_variable_exclusions <- c(
"sex_labelled",
"depressive_disorder_labelled",
"anxiety_disorder_labelled",
"psychotic_disorder_labelled",
"bipolar_disorder_labelled",
"total_COPING_waves_labelled",
"total_COPING_waves_binary_labelled"
)
#Note: Gender appears twice and sex also appears. Only gender should appear!
glad_coping_participation %>%
select(all_of(ends_with("_labelled"))) %>%
select(-all_of(COPING_baseline_table_variable_exclusions)) %>%
tbl_summary(missing_text = "Missing",
by = "completed_baseline_labelled")
COPING_baseline_table_variable_exclusions <- c(
"sex_labelled",
"depressive_disorder_labelled",
"anxiety_disorder_labelled",
"psychotic_disorder_labelled",
"bipolar_disorder_labelled",
"completed_baseline_labelled",
"total_COPING_waves_labelled"
)
COPING_waves_table_variable_exclusions <- c(
"sex_labelled",
"depressive_disorder_labelled",
"anxiety_disorder_labelled",
"psychotic_disorder_labelled",
"bipolar_disorder_labelled",
"completed_baseline_labelled",
"total_COPING_waves_labelled"
)
COPING_waves_table_variable_exclusions <- c(
"sex_labelled",
"depressive_disorder_labelled",
"anxiety_disorder_labelled",
"psychotic_disorder_labelled",
"bipolar_disorder_labelled",
"completed_baseline_labelled",
"total_COPING_waves_labelled"
)
glad_coping_participation %>%
select(all_of(ends_with("_labelled"))) %>%
select(-all_of(COPING_waves_table_variable_exclusions)) %>%
tbl_summary(missing_text = "Missing",
by = "total_COPING_waves_binary_labelled")
age_group_plot <- glad_coping_participation %>%
ggplot(aes(x = age_groups_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Age (years)",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme(axis.text.x = element_text(angle = 70, vjust = 0.5)) +
theme_classic() +
theme(legend.position = "none")
#Check plot
age_group_plot
age_group_plot <- glad_coping_participation %>%
ggplot(aes(x = age_groups_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Age (years)",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(angle = 70, vjust = 0.5))
#Check plot
age_group_plot
age_group_plot <- glad_coping_participation %>%
ggplot(aes(x = age_groups_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Age (years)",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme_classic() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(angle = 70, vjust = 0.5)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
#Check plot
age_group_plot
age_COPING_baseline_plot <- glad_coping_participation %>%
ggplot(aes(x = age_groups_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Age (years)",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme_classic() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(angle = 70, vjust = 0.5)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_COPING_baseline_plot,
employment_plot,
gender_plot,
layout_matrix = plot_layout_matrix,
nrow = 2)
gender_completed_baseline_plot <- glad_coping_participation %>%
ggplot(aes(x = gender_recode_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Gender",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme_classic() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
#Check plot
gender_completed_baseline_plot
gender_completed_baseline_plot <- glad_coping_participation %>%
ggplot(aes(x = gender_recode_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Gender",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme_classic() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
#Check plot
gender_completed_baseline_plot
gender_completed_baseline_plot <- glad_coping_participation %>%
ggplot(aes(x = gender_recode_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Gender",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme_classic() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
#Check plot
gender_completed_baseline_plot
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2)
age_completed_baseline_plot <- glad_coping_participation %>%
ggplot(aes(x = age_groups_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Age (years)",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme_classic() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(angle = 70, vjust = 0.5)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
#Check plot
age_completed_baseline_plot
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2)
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2) +
bottom = textGrob("Non-binary/Self-defined: GLAD (247); NBR/EDGI (41); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2) +
bottom = textGrob("Non-binary/Self-defined: GLAD (247); NBR/EDGI (41); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9))
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: GLAD (247); NBR/EDGI (41); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
glad_coping_participation %>%
group_by(gender_recode_labelled) %>%
count()
glad_coping_participation %>%
group_by(gender_recode_labelled, completed_baseline_labelled) %>%
count()
gender_completed_baseline_plot <- glad_coping_participation %>%
filter(gender_recode_labelled != "Non-binary/prefer to self-define") %>%
ggplot(aes(x = gender_recode_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Gender",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme_classic() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
#Check plot
gender_completed_baseline_plot
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: Did/Did not complete baseline (244; 457)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
ethnic_minority_plot <- glad_coping_participation %>%
drop_na(ethnicity_labelled) %>%
filter(ethnicity_labelled != "White") %>%
drop_na(ethnicity_labelled) %>%
ggplot(aes(x = ethnicity_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Ethnic minority identity",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "top-left")
#Check plot
ethnic_minority_plot
ethnic_minority_plot <- glad_coping_participation %>%
drop_na(ethnicity_labelled) %>%
filter(ethnicity_labelled != "White") %>%
drop_na(ethnicity_labelled) %>%
ggplot(aes(x = ethnicity_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Ethnic minority identity",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "top")
#Check plot
ethnic_minority_plot
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: Did/Did not complete baseline (244; 457)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
ethnic_minority_plot <- glad_coping_participation %>%
drop_na(ethnicity_labelled) %>%
filter(ethnicity_labelled != "White") %>%
drop_na(ethnicity_labelled) %>%
ggplot(aes(x = ethnicity_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Ethnic minority identity",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
theme_classic() +
theme(legend.position = "top",
legend.title = element_blank())
#Check plot
ethnic_minority_plot
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: Did/Did not complete baseline (244; 457)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
gender_completed_baseline_plot <- glad_coping_participation %>%
filter(gender_recode_labelled != "Non-binary/prefer to self-define") %>%
ggplot(aes(x = gender_recode_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Gender",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
theme_classic() +
theme(legend.position = "none") +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: Did/Did not complete baseline (244; 457)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
ethnic_minority_plot <- glad_coping_participation %>%
drop_na(ethnicity_labelled) %>%
filter(ethnicity_labelled != "White") %>%
drop_na(ethnicity_labelled) %>%
ggplot(aes(x = ethnicity_labelled, fill = completed_baseline_labelled)) +
geom_bar(position = "dodge") +
labs(x = "Ethnic minority identity",
y = "N participants") +
scale_fill_manual(values = glad_coping_palette2) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme_classic() +
theme(legend.position = "top",
legend.title = element_blank()) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
#Check plot
ethnic_minority_plot
demographics_completed_baseline_plot <- grid.arrange(ethnic_minority_plot,
age_completed_baseline_plot,
employment_plot,
gender_completed_baseline_plot,
layout_matrix = plot_layout_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: Did/Did not complete baseline (244; 457)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
